{"version":3,"sources":["../../src/models/scroll-handler.ts"],"names":[],"mappings":"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","file":"scroll-handler.js","sourceRoot":"","sourcesContent":["import { NgZone } from '@angular/core';\nimport { TimelineMax } from 'gsap';\nimport { Observable } from 'rxjs/Observable';\nimport { Subject } from 'rxjs/Subject';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { ScrollService } from '../services/scroll.service';\nimport { ScrollTriggerDirective } from '../directives/scroll-trigger/scroll-trigger.directive';\nimport { ScrollMapItem } from './scroll-map-item';\nimport * as _ from 'lodash';\n\nexport type ScrollHandlerOptions = {\n  horizontal?: boolean,\n  translate?: boolean,\n  initialPosition?: number,\n  viewport?: any,\n  overrideScroll?: boolean,\n  scrollMap?: ScrollMapItem[];\n};\n\nexport class ScrollHandler {\n\n  enabled = true;\n  horizontal: boolean;\n  translate: boolean;\n  initialPosition: number;\n  viewport: any;\n  overrideScroll: boolean;\n  _scrollMap: ScrollMapItem[];\n  timeline = new TimelineMax();\n  scrollListener: any;\n  mouseWheelListener: any;\n  touchStartListener: any;\n  touchMoveListener: any;\n  touchEndListener: any;\n  resizeListener: any;\n  animatingScroll = false;\n  instantPosition = 0;\n  _position = new BehaviorSubject<number>(0);\n  _scrollMapPosition = new BehaviorSubject<{ x: number, y: number }>(undefined);\n  _viewportSize;\n  _contentSize;\n  lastTouch;\n  triggers: { trigger: ScrollTriggerDirective, activated: boolean }[] = [];\n  previousScrollPosition = 0;\n  previousStickTo: ScrollTriggerDirective;\n  subscriptions: Subscription[] = [];\n  wheelEventReleased = new Subject<any>();\n  wheelEventCaptured = false;\n\n  constructor(private service: ScrollService,\n              public element: HTMLElement,\n              private zone: NgZone,\n              options: ScrollHandlerOptions) {\n    this.horizontal = options.horizontal || false;\n    this.translate = options.translate || false;\n    this.initialPosition = options.initialPosition || 0;\n    this.viewport = options.viewport || element;\n    this.overrideScroll = options.overrideScroll || true;\n    this.scrollMap = options.scrollMap;\n\n    if (this.initialPosition) {\n      this.scrollTo(this.initialPosition, 0);\n    }\n\n    this.setInitialPosition();\n    this.updateViewportSize();\n    this.updateContentSize();\n  }\n\n  set scrollMap(scrollMap) {\n    this._scrollMap = scrollMap;\n    this.setInitialPosition();\n  }\n\n  setInitialPosition() {\n    let value;\n\n    if (this._position == undefined && this.initialPosition) {\n      value = this.initialPosition;\n    } else {\n      value = this.getInstantPosition();\n    }\n\n    this.instantPosition = value;\n    this._position.next(value);\n  }\n\n  getInstantPosition(): number {\n    if (this._scrollMap) {\n      return this.element.scrollLeft + this.element.scrollTop;\n    } else {\n      return this.horizontal ? this.element.scrollLeft : this.element.scrollTop;\n    }\n  }\n\n  addTrigger(trigger) {\n    this.triggers.push({ trigger: trigger, activated: false });\n  }\n\n  removeTrigger(trigger) {\n    this.triggers = this.triggers.filter(item => item !== trigger.trigger);\n  }\n\n  enable() {\n    this.enabled = true;\n  }\n\n  disable() {\n    this.enabled = false;\n  }\n\n  bind() {\n    this.subscriptions.push(this.wheelEventReleased.debounceTime(600).subscribe(() => this.handleWheelReleaseEvent()));\n\n    this.zone.runOutsideAngular(() => {\n      this.scrollListener = () => {\n        return this.handleScrollEvent();\n      };\n\n      this.resizeListener = () => {\n        return this.handleResizeEvent();\n      };\n\n      this.viewport.addEventListener('scroll', this.scrollListener);\n      window.addEventListener('resize', this.resizeListener);\n\n      if (this.overrideScroll) {\n        if (this.mouseWheelListener) {\n          return;\n        }\n\n        this.mouseWheelListener = e => {\n          return this.handleWheelEvent(e);\n        };\n\n        this.touchStartListener = e => {\n          return this.handleTouchStartEvent(e);\n        };\n\n        this.touchMoveListener = e => {\n          return this.handleTouchMoveEvent(e);\n        };\n\n        this.touchEndListener = () => {\n          return this.handleTouchEndEvent();\n        };\n\n        document.body.addEventListener('wheel', this.mouseWheelListener);\n        document.body.addEventListener('touchstart', this.touchStartListener);\n        document.body.addEventListener('touchmove', this.touchMoveListener);\n        document.body.addEventListener('touchend', this.touchEndListener);\n      }\n    });\n  }\n\n  unbind() {\n    this.subscriptions.forEach(item => item.unsubscribe());\n\n    if (this.scrollListener) {\n      this.viewport.removeEventListener('scroll', this.scrollListener);\n    }\n\n    if (this.mouseWheelListener) {\n      document.body.removeEventListener('wheel', this.mouseWheelListener);\n    }\n\n    if (this.touchStartListener) {\n      document.body.removeEventListener('touchstart', this.touchStartListener);\n    }\n\n    if (this.touchMoveListener) {\n      document.body.removeEventListener('touchend', this.touchMoveListener);\n    }\n\n    if (this.touchEndListener) {\n      document.body.removeEventListener('touchmove', this.touchEndListener);\n    }\n\n    if (this.resizeListener) {\n      window.removeEventListener('resize', this.resizeListener);\n    }\n  }\n\n  handleScrollEvent() {\n    this.onScroll();\n  }\n\n  handleWheelEvent(e) {\n    if (!this.service.handleAllowed(this) || !this.enabled) {\n      e.preventDefault();\n      return false;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (this.wheelEventCaptured) {\n      if (this.animatingScroll) {\n        this.wheelEventReleased.next(e);\n      }\n\n      return;\n    }\n\n    if (this.animatingScroll) {\n      return false;\n    }\n\n    let deltaX, deltaY;\n    const speed = 1;\n    const DELTA_SCALE = {\n      STANDARD: 1,\n      OTHERS: -3,\n    };\n\n    if (e['deltaX'] != undefined) {\n      const deltaModes = [1.0, 28.0, 500.0];\n      const deltaMode = deltaModes[e.deltaMode] || deltaModes[0];\n\n      deltaX = e.deltaX / DELTA_SCALE.STANDARD * deltaMode;\n      deltaY = e.deltaY / DELTA_SCALE.STANDARD * deltaMode;\n    } else if (e['wheelDeltaX'] != undefined) {\n      deltaX = e.wheelDeltaX / DELTA_SCALE.OTHERS;\n      deltaY = e.wheelDeltaY / DELTA_SCALE.OTHERS;\n    } else {\n      deltaX = 0;\n      deltaY = e.wheelDelta / DELTA_SCALE.OTHERS;\n    }\n\n    deltaX *= speed;\n    deltaY *= speed;\n\n    deltaX = Math.round(deltaX);\n    deltaY = Math.round(deltaY);\n\n    if (this._scrollMap) {\n      this.handleScrollMapScrollEvent(deltaX, deltaY);\n    } else {\n      this.handleDefaultScrollEvent(deltaX, deltaY);\n    }\n\n    return false;\n  }\n\n  handleWheelReleaseEvent() {\n    this.wheelEventCaptured = false;\n  }\n\n  handleTouchStartEvent(e) {\n    if (!this.service.handleAllowed(this) || !this.enabled) {\n      return false;\n    }\n\n    e.stopPropagation();\n\n    if (this.animatingScroll) {\n      return false;\n    }\n\n    this.lastTouch = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n\n    return false;\n  }\n\n  handleTouchMoveEvent(e) {\n    if (!this.service.handleAllowed(this)) {\n      return false;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (this.animatingScroll) {\n      return false;\n    }\n\n    const speed = 1;\n    const touch = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n    const deltaX = Math.round(this.lastTouch.x - touch.x) * speed;\n    const deltaY = Math.round(this.lastTouch.y - touch.y) * speed;\n\n    if (this.animatingScroll) {\n      return false;\n    }\n\n    if (this._scrollMap) {\n      this.handleScrollMapScrollEvent(deltaX, deltaY);\n    } else {\n      this.handleDefaultScrollEvent(deltaX, deltaY);\n    }\n\n    this.lastTouch = touch;\n  }\n\n  handleTouchEndEvent() {\n    this.lastTouch = undefined;\n  }\n\n  handleScrollMapScrollEvent(deltaX, deltaY) {\n    let delta = deltaX + deltaY;\n\n    const totalDistance = this._scrollMap\n      .map(item => item.getDistance(this.viewportSize))\n      .reduce((sum, current) => sum + current);\n\n    let position = this.position;\n\n    position += delta;\n\n    if (position < 0) {\n      position = 0;\n    } else if (position > totalDistance) {\n      position = totalDistance;\n    }\n\n    this.scrollToMapPosition(position, 0.1);\n  }\n\n  handleDefaultScrollEvent(deltaX, deltaY) {\n    let delta = deltaX + deltaY;\n\n    if (this.preventScroll(delta)) {\n      return;\n    }\n\n    let position = this._position.value;\n\n    position += delta;\n\n    if (position < 0) {\n      position = 0;\n    }\n\n    this.scrollToBasicPosition(position, 0.16);\n  }\n\n  handleResizeEvent() {\n    this.updateViewportSize();\n    this.updateContentSize();\n    this.updateTriggerPositions();\n    this.updateScrollMapItems();\n  }\n\n  scrollTo(position, duration, ease = undefined): Observable<{}> {\n    let obs: Observable<{}>;\n    this.animatingScroll = true;\n\n    if (this._scrollMap) {\n      obs = this.scrollToMapPosition(position, duration, ease);\n    } else {\n      obs = this.scrollToBasicPosition(position, duration, ease);\n    }\n\n    obs.subscribe(() => this.animatingScroll = false);\n\n    return obs;\n  }\n\n  scrollToMapPosition(position, duration, ease = undefined): Observable<{}> {\n    let mapDistance = 0;\n    let mapPosition = { x: 0, y: 0 };\n\n    _.each(this._scrollMap, item => {\n      const distance = item.getDistance(this.viewportSize);\n      const percentage = (position - mapDistance) / distance;\n      const insidePosition = item.getPosition(this.viewportSize, percentage);\n\n      if (distance >= 0) {\n        mapDistance += distance;\n      }\n\n      mapPosition.x += insidePosition.x;\n      mapPosition.y += insidePosition.y;\n\n      if (percentage >= 0 && percentage < 1) {\n        return false;\n      }\n    });\n\n    let params = {\n      scrollLeft: mapPosition.x,\n      scrollTop: mapPosition.y\n    };\n    let obs = new Subject();\n\n    if (ease) {\n      params['ease'] = ease;\n    }\n\n    params['onComplete'] = () => {\n      obs.next();\n    };\n\n    this.previousScrollPosition = this.position;\n\n    if (this._position.value != position) {\n      this._position.next(position);\n    }\n\n    if (this._scrollMapPosition.value == undefined\n      || this._scrollMapPosition.value.x !== mapPosition.x\n      || this._scrollMapPosition.value.y !== mapPosition.y) {\n      this._scrollMapPosition.next(mapPosition);\n    }\n\n    if (duration) {\n      this.timeline = this.timeline.clear().to(this.element, duration, params);\n    } else {\n      this.timeline = this.timeline.clear().set(this.element, params);\n    }\n\n    return obs;\n  }\n\n  scrollToBasicPosition(position, duration, ease = undefined): Observable<{}> {\n    this.previousScrollPosition = this.position;\n\n    if (position != this._position.value) {\n      this._position.next(position);\n    }\n\n    let params;\n    let obs = new Subject();\n\n    if (this.translate) {\n      params = this.horizontal ? { x: position } : { y: position };\n    } else {\n      params = this.horizontal ? { scrollLeft: position } : { scrollTop: position };\n    }\n\n    if (ease) {\n      params['ease'] = ease;\n    }\n\n    params['onComplete'] = () => {\n      obs.next();\n      this.animatingScroll = false; // workaround\n    };\n\n    if (duration) {\n      this.timeline = this.timeline.clear().to(this.element, duration, params);\n    } else {\n      this.timeline = this.timeline.clear().set(this.element, params);\n    }\n\n    obs.subscribe(() => {\n      position = this._position.value;\n\n      if (position > this.getInstantPosition()) {\n        this.updateContentSize();\n      }\n\n      position = this.normalizePosition(position);\n\n      if (position != this._position.value) {\n        this._position.next(position);\n      }\n    });\n\n    return obs;\n  }\n\n  get viewportSize() {\n    return this._viewportSize;\n  }\n\n  updateViewportSize() {\n    this._viewportSize = this.translate ? {\n      width: this.viewport.parentNode['clientWidth'],\n      height: this.viewport.parentNode['clientHeight']\n    } : {\n      width: this.viewport.clientWidth || this.viewport.innerWidth,\n      height: this.viewport.clientHeight || this.viewport.innerHeight\n    };\n  }\n\n  get contentSize() {\n    return this._contentSize;\n  }\n\n  updateContentSize() {\n    this._contentSize = this.translate ? {\n      width: this.element.offsetWidth,\n      height: this.element.offsetHeight\n    } : {\n      width: this.element.scrollWidth,\n      height: this.element.scrollHeight\n    };\n  }\n\n  updateTriggerPositions() {\n    const changes = this.triggers.map(trigger => trigger.trigger.updatePosition());\n\n    if (changes.filter(item => item).length) {\n      this.onScroll();\n    }\n  }\n\n  updateScrollMapItems() {\n    if (!this._scrollMap) {\n      return;\n    }\n    this._scrollMap.forEach(item => item.onLayoutUpdated());\n  }\n\n  get position$(): Observable<number> {\n    return this._position.asObservable();\n  }\n\n  get position() {\n    return this._position.value;\n  }\n\n  get scrollMapPosition(): Observable<{ x: number, y: number }> {\n    return this._scrollMapPosition.asObservable();\n  }\n\n  normalizePosition(position) {\n    if (position < 0) {\n      position = 0;\n    } else if (this.horizontal && position > this.contentSize.width - this.viewportSize.width) {\n      position = this.contentSize.width - this.viewportSize.width;\n    } else if (!this.horizontal && position > this.contentSize.height - this.viewportSize.height) {\n      position = this.contentSize.height - this.viewportSize.height;\n    }\n\n    return position;\n  }\n\n  get scrollMapItemPositions() {\n    let sum = 0;\n    return this._scrollMap.map(item => {\n      const distance = item.getDistance(this.viewportSize);\n      const obj = {\n        startPosition: sum,\n        endPosition: sum + distance,\n        item: item\n      };\n      sum += distance;\n      return obj;\n    });\n  }\n\n  preventScroll(delta): boolean {\n    const scrollMapItems = this._scrollMap ? this.scrollMapItemPositions : undefined;\n    const direction = delta != 0 ? delta / Math.abs(delta) : 0;\n    let stickTo: ScrollTriggerDirective;\n\n    for (let trigger of this.triggers) {\n      let triggerPosition = trigger.trigger.position;\n      const triggerDelta = triggerPosition - this.position;\n      const triggerDirection = triggerDelta != 0 ? triggerDelta / Math.abs(triggerDelta) : 0;\n\n      if (this._scrollMap) {\n        const scrollMapItem = _.first(scrollMapItems.filter(item => item.item === trigger.trigger.scrollMapItem));\n\n        if (scrollMapItem) {\n          triggerPosition += scrollMapItem.startPosition;\n        }\n      }\n\n      if (trigger.trigger.stick != undefined\n          && triggerDirection == direction\n          && this.previousStickTo != trigger.trigger\n          && Math.abs(triggerPosition - this.position) <= this.viewportSize.width + trigger.trigger.stick\n          && (!stickTo || Math.abs(stickTo.position - this.position) > Math.abs(triggerDelta))) {\n        stickTo = trigger.trigger;\n      }\n    }\n\n    if (stickTo) {\n      this.previousStickTo = stickTo;\n      this.wheelEventCaptured = true;\n      this.wheelEventReleased.next();\n      this.scrollTo(stickTo.position, 0.9);\n      return true;\n    }\n\n    return false;\n  }\n\n  onScroll() {\n    const scrollMapItems = this._scrollMap ? this.scrollMapItemPositions : undefined;\n    let triggered = false;\n\n    this.instantPosition = this.getInstantPosition();\n\n    for (let trigger of this.triggers) {\n      let triggerPosition = trigger.trigger.position;\n\n      if (this._scrollMap) {\n        const scrollMapItem = _.first(scrollMapItems.filter(item => item.item === trigger.trigger.scrollMapItem));\n\n        if (scrollMapItem) {\n          triggerPosition += scrollMapItem.startPosition;\n        }\n      }\n\n      if (this.position >= triggerPosition && !trigger.activated) {\n        trigger.activated = true;\n        trigger.trigger.onActivated({\n          triggerPosition: triggerPosition,\n          previousScrollPosition: this.previousScrollPosition,\n          scrollPosition: this.position\n        });\n        triggered = true;\n      } else if (this.position < triggerPosition && trigger.activated) {\n        trigger.activated = false;\n        trigger.trigger.onDeactivated({\n          triggerPosition: triggerPosition,\n          previousScrollPosition: this.previousScrollPosition,\n          scrollPosition: this.position\n        });\n        triggered = true;\n      }\n    }\n\n    if (triggered) {\n      this.updateContentSize();\n    }\n  }\n}\n"]}