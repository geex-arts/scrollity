{"version":3,"sources":["../../../../src/models/handlers/map-scroll-handler/element-scroll-map-item.ts"],"names":[],"mappings":"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","file":"element-scroll-map-item.js","sourceRoot":"","sourcesContent":["import { ScrollMapItem, ScrollPosition, ViewportSize } from './scroll-map-item';\n\nexport type ElementScrollMapItemOptions = {\n  element: HTMLElement;\n  horizontal?: boolean;\n  scrollToDisappear?: boolean;\n};\n\nexport class ElementScrollMapItem implements ScrollMapItem {\n\n  element: HTMLElement;\n  horizontal: boolean;\n  scrollToDisappear: boolean;\n  cachedDistance: number;\n\n  constructor(options: ElementScrollMapItemOptions) {\n    this.element = options.element;\n    this.horizontal = options.horizontal || false;\n    this.scrollToDisappear = options.scrollToDisappear || false;\n  }\n\n  outerWidth(element: HTMLElement) {\n    let result = this.element.offsetWidth;\n\n    result += parseInt(window.getComputedStyle(element).getPropertyValue('margin-left'), 10);\n    result += parseInt(window.getComputedStyle(element).getPropertyValue('margin-right'), 10);\n\n    return result;\n  }\n\n  outerHeight(element: HTMLElement) {\n    let result = this.element.offsetHeight;\n\n    result += parseInt(window.getComputedStyle(element).getPropertyValue('margin-top'), 10);\n    result += parseInt(window.getComputedStyle(element).getPropertyValue('margin-bottom'), 10);\n\n    return result;\n  }\n\n  getDistance(viewportSize: ViewportSize): number {\n    if (this.cachedDistance !== undefined) {\n      return this.cachedDistance;\n    }\n\n    let value;\n\n    if (this.scrollToDisappear) {\n      value = this.horizontal\n        ? this.outerWidth(this.element)\n        : this.outerHeight(this.element);\n    } else {\n      value = this.horizontal\n        ? this.outerWidth(this.element) - viewportSize.width\n        : this.outerHeight(this.element) - viewportSize.height;\n    }\n\n    this.cachedDistance = value;\n\n    return value;\n  }\n\n  getPosition(viewportSize: ViewportSize, progress: number): ScrollPosition {\n    if (progress > 1) {\n      progress = 1;\n    } else if (progress < 0) {\n      progress = 0;\n    }\n\n    return this.horizontal ? {\n      x: this.getDistance(viewportSize) * progress,\n      y: 0\n    } : {\n      x: 0,\n      y: this.getDistance(viewportSize) * progress\n    };\n  }\n\n  getElementScrollPosition(element: HTMLElement): number {\n    return this.horizontal\n      ? this.getElementOffset(element).left - this.getElementOffset(this.element).left\n      : this.getElementOffset(element).top - this.getElementOffset(this.element).top;\n  }\n\n  getDirection(): number {\n    return this.horizontal ? 90 : 180;\n  }\n\n  private getElementOffset(element, relativeTo = undefined) {\n    let x = 0;\n    let y = 0;\n\n    while (element && !isNaN(element.offsetLeft) && !isNaN(element.offsetTop)) {\n      x += element.offsetLeft - element.scrollLeft;\n      y += element.offsetTop - element.scrollTop;\n      element = element.offsetParent;\n\n      if (relativeTo && element == relativeTo) {\n        break;\n      }\n    }\n\n    return { top: y, left: x };\n  }\n\n  onLayoutUpdated(): void {\n    this.cachedDistance = undefined;\n  }\n}\n"]}