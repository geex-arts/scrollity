{"version":3,"sources":["../../../src/directives/scroll-trigger/scroll-trigger.directive.ts"],"names":[],"mappings":";;AAAA,sCAEuB;AAGvB,oEAAkE;AAyBlE;IAeE,gCAAoB,EAAc,EAAU,eAAgC;QAAxD,OAAE,GAAF,EAAE,CAAY;QAAU,oBAAe,GAAf,eAAe,CAAiB;QAZ3E,qBAAgB,GAAG,IAAI,mBAAY,EAAsB,CAAC;QAC1D,uBAAkB,GAAG,IAAI,mBAAY,EAAsB,CAAC;QAC5D,kBAAa,GAAG,IAAI,mBAAY,EAAsB,CAAC;IAUwB,CAAC;IAEjF,4CAAW,GAAX,UAAY,OAAsB;QAChC,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC;QAE9C,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACb,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;gBACjB,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBACjC,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;gBACzB,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;gBAChC,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;gBAC/B,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;gBACxB,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;gBAC/B,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;YACzB,CAAC;YAED,MAAM,CAAC;QACT,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;YACrB,MAAM,CAAC;QACT,CAAC;QAED,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,IAAI,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;QACvF,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC;QACtF,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/D,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAE3C,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAE1B,EAAE,CAAC,CAAC,KAAK,IAAI,SAAS,CAAC,CAAC,CAAC;YACvB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YACrE,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC;QACzE,CAAC;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QAEnB,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IACxC,CAAC;IAED,4CAAW,GAAX;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAC3C,CAAC;IACH,CAAC;IAED,+CAAc,GAAd;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC;QACT,CAAC;QAED,IAAI,QAAQ,CAAC;QACb,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC;QAE1G,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;YACvB,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,wBAAwB,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;QAChF,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,QAAQ,GAAG,UAAU;gBACnB,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI;gBAClF,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC;QACtF,CAAC;QAED,QAAQ,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC;QAE7B,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,CAAC,CAAC,CAAC;YAC7B,QAAQ,IAAI,UAAU;gBACpB,CAAC,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,WAAW;gBACzD,CAAC,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC;QAC/D,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,CAAC,CAAC;YAC5B,QAAQ,IAAI,UAAU;gBACpB,CAAC,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK;gBACtD,CAAC,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC;QAC5D,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,QAAQ,CAAC,CAAC,CAAC;YAC/B,MAAM,CAAC,KAAK,CAAC;QACf,CAAC;QAED,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,sBAAI,4CAAQ;aAAZ;YACE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QACxB,CAAC;;;OAAA;IAED,sBAAI,2CAAO;aAAX;YACE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QAC/B,CAAC;;;OAAA;IAED,4CAAW,GAAX,UAAY,KAAyB;QACnC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACjC,CAAC;IAED,8CAAa,GAAb,UAAc,KAAyB;QACrC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACpC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACjC,CAAC;IACI,iCAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,gBAAS,EAAE,IAAI,EAAE,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,EAAG,EAAE;KAC9D,CAAC;IACF,kBAAkB;IACX,qCAAc,GAAmE,cAAM,OAAA;QAC9F,EAAC,IAAI,EAAE,iBAAU,GAAG;QACpB,EAAC,IAAI,EAAE,kCAAe,GAAG;KACxB,EAH6F,CAG7F,CAAC;IACK,qCAAc,GAA2C;QAChE,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,YAAK,EAAE,IAAI,EAAE,CAAC,gBAAgB,EAAG,EAAE,EAAE;QACzD,kBAAkB,EAAE,CAAC,EAAE,IAAI,EAAE,aAAM,EAAE,IAAI,EAAE,CAAC,kBAAkB,EAAG,EAAE,EAAE;QACrE,oBAAoB,EAAE,CAAC,EAAE,IAAI,EAAE,aAAM,EAAE,IAAI,EAAE,CAAC,oBAAoB,EAAG,EAAE,EAAE;QACzE,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,aAAM,EAAE,IAAI,EAAE,CAAC,eAAe,EAAG,EAAE,EAAE;KAC9D,CAAC;IACF,6BAAC;CApID,AAoIC,IAAA;AApIY,wDAAsB","file":"scroll-trigger.directive.js","sourceRoot":"","sourcesContent":["import {\n  Directive, ElementRef, EventEmitter, Input, OnChanges, OnDestroy, Output, SimpleChanges\n} from '@angular/core';\n\nimport { ScrollHandler } from '../../models/handlers/scroll-handler';\nimport { DocumentService } from '../../services/document.service';\nimport { ScrollMapItem } from '../../models/handlers/map-scroll-handler/scroll-map-item';\n\nexport type ScrollTriggerStickOptions = {\n  distance?: number,\n  duration?: number,\n  ease?: any\n};\n\nexport type ScrollTriggerOptions = {\n  handler: ScrollHandler,\n  elementTrigger?: number,\n  screenTrigger?: number,\n  offset?: number,\n  scrollMapItem?: ScrollMapItem,\n  stick?: ScrollTriggerStickOptions\n};\n\nexport type ScrollTriggerEvent = {\n  triggerPosition: number,\n  previousScrollPosition: number,\n  scrollPosition: number\n};\n\n\nexport class ScrollTriggerDirective implements OnChanges, OnDestroy {\n\n   options: ScrollTriggerOptions;\n   triggerActivated = new EventEmitter<ScrollTriggerEvent>();\n   triggerDeactivated = new EventEmitter<ScrollTriggerEvent>();\n   triggerPassed = new EventEmitter<ScrollTriggerEvent>();\n\n  handler: ScrollHandler;\n  elementTrigger: number;\n  screenTrigger: number;\n  offset: number;\n  scrollMapItem: ScrollMapItem;\n  stick: ScrollTriggerStickOptions;\n  private _position: number;\n\n  constructor(private el: ElementRef, private documentService: DocumentService) { }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    let options = changes['options'].currentValue;\n\n    if (!options) {\n      if (this.handler) {\n        this.handler.removeTrigger(this);\n        this.handler = undefined;\n        this.elementTrigger = undefined;\n        this.screenTrigger = undefined;\n        this.offset = undefined;\n        this.scrollMapItem = undefined;\n        this.stick = undefined;\n      }\n\n      return;\n    }\n\n    if (!options.handler) {\n      return;\n    }\n\n    this.handler = options.handler;\n    this.elementTrigger = options.elementTrigger != undefined ? options.elementTrigger : 0;\n    this.screenTrigger = options.screenTrigger != undefined ? options.screenTrigger : 0.5;\n    this.offset = options.offset != undefined ? options.offset : 0;\n    this.scrollMapItem = options.scrollMapItem;\n\n    let stick = options.stick;\n\n    if (stick != undefined) {\n      stick.distance = stick['distance'] != undefined ? stick.distance : 0;\n      stick.duration = stick['duration'] != undefined ? stick.duration : 1.2;\n    }\n\n    this.stick = stick;\n\n    this.updatePosition();\n    this.options.handler.addTrigger(this);\n  }\n\n  ngOnDestroy(): void {\n    if (this.options.handler) {\n      this.options.handler.removeTrigger(this);\n    }\n  }\n\n  updatePosition(): boolean {\n    if (!this.handler) {\n      return;\n    }\n\n    let position;\n    const horizontal = this.scrollMapItem ? this.scrollMapItem.getDirection() == 90 : this.handler.horizontal;\n\n    if (this.scrollMapItem) {\n      position = this.scrollMapItem.getElementScrollPosition(this.el.nativeElement);\n    } else {\n      position = horizontal\n        ? this.documentService.getOffset(this.el.nativeElement, this.handler.element).left\n        : this.documentService.getOffset(this.el.nativeElement, this.handler.element).top;\n    }\n\n    position += this.offset || 0;\n\n    if (this.elementTrigger != 0) {\n      position += horizontal\n        ? this.elementTrigger * this.el.nativeElement.offsetWidth\n        : this.elementTrigger * this.el.nativeElement.offsetHeight;\n    }\n\n    if (this.screenTrigger != 0) {\n      position -= horizontal\n        ? this.screenTrigger * this.handler.viewportSize.width\n        : this.screenTrigger * this.handler.viewportSize.height;\n    }\n\n    if (this._position == position) {\n      return false;\n    }\n\n    this._position = position;\n    return true;\n  }\n\n  get position() {\n    return this._position;\n  }\n\n  get element() {\n    return this.el.nativeElement;\n  }\n\n  onActivated(event: ScrollTriggerEvent) {\n    this.triggerActivated.emit(event);\n    this.triggerPassed.emit(event);\n  }\n\n  onDeactivated(event: ScrollTriggerEvent) {\n    this.triggerDeactivated.emit(event);\n    this.triggerPassed.emit(event);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{ selector: '[scroll-trigger]' }, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: DocumentService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'options': [{ type: Input, args: ['scroll-trigger', ] },],\n'triggerActivated': [{ type: Output, args: ['triggeractivated', ] },],\n'triggerDeactivated': [{ type: Output, args: ['triggerdeactivated', ] },],\n'triggerPassed': [{ type: Output, args: ['triggerpassed', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}